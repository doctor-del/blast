window.__require=function e(t,o,r){function i(s,c){if(!o[s]){if(!t[s]){var l=s.split("/");if(l=l[l.length-1],!t[l]){var a="function"==typeof __require&&__require;if(!c&&a)return a(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var p=o[s]={exports:{}};t[s][0].call(p.exports,function(e){return i(t[s][1][e]||e)},p,p.exports,e,t,o,r)}return o[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<r.length;s++)i(r[s]);return i}({BoardModel:[function(e,t,o){"use strict";cc._RF.push(t,"d0518FzdhlCXaxlndqFbxL3","BoardModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.Block=o.BlockType=void 0;var r,i=e("../game/types/Cell");(function(e){e[e.Normal=0]="Normal",e[e.SuperRow=100]="SuperRow",e[e.SuperColumn=101]="SuperColumn"})(r=o.BlockType||(o.BlockType={}));var n=function(e,t){void 0===t&&(t=r.Normal),this.color=e,this.type=t};o.Block=n;var s=function(){function e(e,t){this.grid=[],this.maxTileTypes=5,this.rows=e,this.cols=t,this.generate()}return e.prototype.generate=function(){for(var e=0;e<this.rows;e++){this.grid[e]=[];for(var t=0;t<this.cols;t++)this.grid[e][t]=new n(this.randomType())}},e.prototype.randomType=function(){return Math.floor(Math.random()*this.maxTileTypes)},e.prototype.get=function(e,t){return this.isValid(e,t)?this.grid[e][t]:null},e.prototype.setBlockType=function(e,t,o){this.grid[e][t].type=o},e.prototype.isValid=function(e,t){return e>=0&&e<this.rows&&t>=0&&t<this.cols},e.prototype.findGroup=function(e,t){var o=this.get(e,t);if(null===o)return[];for(var r={},n=[new i.default(e,t)],s=[];n.length;){var c=n.pop(),l=c.row+"_"+c.col;r[l]||(r[l]=!0,this.isValid(c.row,c.col)&&this.get(c.row,c.col).color===o.color&&(s.push(c),n.push(new i.default(c.row+1,c.col)),n.push(new i.default(c.row-1,c.col)),n.push(new i.default(c.row,c.col+1)),n.push(new i.default(c.row,c.col-1))))}return s},e.prototype.getCellsInRadius=function(e,t,o){for(var r=[],n=e-o;n<=e+o;n++)for(var s=t-o;s<=t+o;s++)this.isInside(n,s)&&null!==this.grid[n][s]&&r.push(new i.default(n,s));return r},e.prototype.isInside=function(e,t){return e>=0&&e<this.rows&&t>=0&&t<this.cols},e.prototype.remove=function(e){var t=this;e.forEach(function(e){t.grid[e.row][e.col]=null})},e.prototype.collapse=function(){for(var e=[],t=0;t<this.cols;t++){for(var o=this.rows-1,r=this.rows-1;r>=0;r--)null!==this.grid[r][t]&&(r!==o&&(this.grid[o][t]=this.grid[r][t],this.grid[r][t]=null,e.push({fromR:r,toR:o,c:t})),o--);for(r=o;r>=0;r--)this.grid[r][t]=new n(this.randomType()),e.push({fromR:-1,toR:r,c:t})}return e},e.prototype.hasAvailableMoves=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++){var o=this.grid[e][t];if(!(null===o||o.type>r.Normal)){if(t+1<this.cols&&this.grid[e][t+1].color===o.color)return!0;if(e+1<this.rows&&this.grid[e+1][t].color===o.color)return!0}}return!1},e.prototype.shuffle=function(){for(var e=this.rows-1;e>=0;e--)for(var t=this.cols-1;t>=0;t--){var o=Math.random()*this.rows|0,r=Math.random()*this.cols|0,i=this.grid[e][t];this.grid[e][t]=this.grid[o][r],this.grid[o][r]=i}},e.prototype.swap=function(e,t){var o=this.grid[e.row][e.col];this.grid[e.row][e.col]=this.grid[t.row][t.col],this.grid[t.row][t.col]=o},e}();o.default=s,cc._RF.pop()},{"../game/types/Cell":"Cell"}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"c7122zIoqtHUL8WlEXMa7Ga","BoardView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./BoardModel"),c=e("../config/GameEvents"),l=e("./TileView"),a=e("./TilePool"),p=e("../config/GameConfig"),u=cc._decorator,h=u.ccclass,f=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pool=null,t.superRowSprite=null,t.superColumnSprite=null,t.tiles=[],t.pendingAnimations=0,t.completeCallback=null,t}return i(t,e),t.prototype.onDestroy=function(){this.node.off(c.GameEvents.TileClicked,this.onTileClicked,this)},t.prototype.init=function(e){this.model=e,this.pool.preload(this.model.rows*this.model.cols),this.node.on(c.GameEvents.TileClicked,this.onTileClicked,this),this.draw()},t.prototype.draw=function(){for(var e=0;e<this.model.rows;e++){this.tiles[e]=[];for(var t=0;t<this.model.cols;t++)this.createTile(e,t)}},t.prototype.createTile=function(e,t){var o=this.pool.get();o.parent=this.node,o.x=t*p.GameConfig.blockSizeW,o.y=-e*p.GameConfig.blockSizeH;var r=o.getComponent(l.default);return r.init(e,t,this.model.get(e,t).color),this.tiles[e][t]=r,r},t.prototype.updateBlockVisual=function(e,t,o){var r=this.getTileNode(e,t);o===s.BlockType.SuperRow&&(r.getComponent(cc.Sprite).spriteFrame=this.superRowSprite),o===s.BlockType.SuperColumn&&(r.getComponent(cc.Sprite).spriteFrame=this.superColumnSprite)},t.prototype.getTileNode=function(e,t){return this.tiles[e][t].node},t.prototype.playRemove=function(e,t){var o=this;this.pendingAnimations=e.length,this.completeCallback=t;for(var r=function(t){var r=e[t],n=i.tiles[r.row][r.col];i.tiles[r.row][r.col]=null,cc.tween(n.node).parallel(cc.tween().to(.15,{scale:0}),cc.tween().to(.15,{opacity:0})).call(function(){o.pool.put(n.node),o.onAnimComplete()}).start()},i=this,n=0;n<e.length;n++)r(n)},t.prototype.playCollapse=function(e,t){if(0!==e.length){this.pendingAnimations=e.length,this.completeCallback=t;for(var o=0;o<e.length;o++){var r=e[o];if(r.fromR>=0){var i=this.tiles[r.fromR][r.c];this.tiles[r.toR][r.c]=i,this.tiles[r.fromR][r.c]=null,i.row=r.toR,i.col=r.c,cc.tween(i.node).to(.2,{y:-r.toR*p.GameConfig.blockSizeH}).call(this.onAnimComplete,this).start()}else(i=this.createTile(r.toR,r.c)).node.y=p.GameConfig.blockSizeH,cc.tween(i.node).to(.2,{y:-r.toR*p.GameConfig.blockSizeH}).call(this.onAnimComplete,this).start()}}else t()},t.prototype.onAnimComplete=function(){if(this.pendingAnimations--,0===this.pendingAnimations&&this.completeCallback){var e=this.completeCallback;this.completeCallback=null,e()}},t.prototype.syncWithModel=function(e){this.pendingAnimations=this.model.rows*this.model.cols,this.completeCallback=e;for(var t=0;t<this.model.rows;t++)for(var o=0;o<this.model.cols;o++){var r=this.tiles[t][o];if(r){var i=this.model.get(t,o);r.setType(i.color),cc.tween(r.node).to(.1,{scale:.8}).to(.1,{scale:1}).call(this.onAnimComplete,this).start()}}},t.prototype.playSwap=function(e,t,o){var r=this,i=this.getTileNode(e.row,e.col),n=this.getTileNode(t.row,t.col),s=i.position.clone(),c=n.position.clone(),l=0,a=function(){2==++l&&(r.swapViewNodes(e,t),o&&o())};cc.tween(i).to(.2,{position:c}).call(a).start(),cc.tween(n).to(.2,{position:s}).call(a).start()},t.prototype.swapViewNodes=function(e,t){var o=this.tiles[e.row][e.col];this.tiles[e.row][e.col]=this.tiles[t.row][t.col],this.tiles[t.row][t.col]=o},t.prototype.onTileClicked=function(e){this.node.emit(c.GameEvents.BoardClicked,e)},n([f(a.default)],t.prototype,"pool",void 0),n([f(cc.SpriteFrame)],t.prototype,"superRowSprite",void 0),n([f(cc.SpriteFrame)],t.prototype,"superColumnSprite",void 0),n([h],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../config/GameConfig":"GameConfig","../config/GameEvents":"GameEvents","./BoardModel":"BoardModel","./TilePool":"TilePool","./TileView":"TileView"}],BoosterView:[function(e,t,o){"use strict";cc._RF.push(t,"b1624YnjF5Htag6BYovR153","BoosterView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterType=void 0;var s,c=e("../config/GameEvents"),l=cc._decorator,a=l.ccclass,p=l.property;(function(e){e[e.Bomb=0]="Bomb",e[e.Teleport=1]="Teleport"})(s=o.BoosterType||(o.BoosterType={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.Bomb,t.slotLabel=null,t.button=null,t}return i(t,e),t.prototype.setBoostLabel=function(e){this.slotLabel.string=""+e},t.prototype.setInteractable=function(e){this.button&&(this.button.interactable=e),this.node.opacity=e?255:120},t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onClick=function(){this.button.interactable&&this.node.parent.emit(c.GameEvents.BoosterClicked,this.type)},n([p(s)],t.prototype,"type",void 0),n([p(cc.Label)],t.prototype,"slotLabel",void 0),n([p(cc.Button)],t.prototype,"button",void 0),n([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../config/GameEvents":"GameEvents"}],Cell:[function(e,t,o){"use strict";cc._RF.push(t,"26a88Y0dpxOdLFv+RmZF8y0","Cell"),Object.defineProperty(o,"__esModule",{value:!0});o.default=function(e,t){this.row=e,this.col=t},cc._RF.pop()},{}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"8f6a7z6SLZM4bPjgMbUJTPm","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfig=o.TileType=void 0,function(e){e[e.Blue=0]="Blue",e[e.Green=1]="Green",e[e.Purpure=2]="Purpure",e[e.Red=3]="Red",e[e.Yellow=4]="Yellow"}(o.TileType||(o.TileType={})),o.GameConfig={rows:9,cols:9,blockSizeW:100,blockSizeH:112,minGroup:2,targetScore:2e3,maxMoves:20,bombMaxCount:2,teleportMaxCount:2,bombRadius:1,superTileCount:5},cc._RF.pop()},{}],GameController:[function(e,t,o){"use strict";cc._RF.push(t,"ac00by8y29JQbXzcbmyWxjk","GameController");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s,c=e("../board/BoardModel"),l=e("../board/BoardView"),a=e("../booster/BoosterView"),p=e("../game/types/Cell"),u=e("../ui/UIController"),h=e("../config/GameEvents"),f=e("../config/GameConfig"),d=cc._decorator,y=d.ccclass,m=d.property;(function(e){e[e.Normal=0]="Normal",e[e.Bomb=1]="Bomb",e[e.TeleportSelectFirst=2]="TeleportSelectFirst",e[e.TeleportSelectSecond=3]="TeleportSelectSecond"})(s||(s={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boardView=null,t.ui=null,t.boosterPanel=null,t.boosters=[],t.reshuffleCount=0,t.MAX_RESHUFFLE=3,t.busy=!1,t.score=0,t.movesLeft=0,t.boosterCounts=new Map,t.inputMode=s.Normal,t.teleportFirst=null,t}return i(t,e),t.prototype.onLoad=function(){this.model=new c.default(f.GameConfig.rows,f.GameConfig.cols),this.boardView.init(this.model),this.boardView.node.on(h.GameEvents.BoardClicked,this.onBlockClicked,this),cc.systemEvent.on(h.GameEvents.RestartGame,this.resetGame,this),this.boosterPanel.on(h.GameEvents.BoosterClicked,this.onBoosterClicked,this),this.boosters=this.boosterPanel.getComponentsInChildren(a.default),this.boosterCounts.set(a.BoosterType.Bomb,f.GameConfig.bombMaxCount),this.boosterCounts.set(a.BoosterType.Teleport,f.GameConfig.teleportMaxCount),this.updateBoosters(),this.score=0,this.movesLeft=f.GameConfig.maxMoves,this.ui.setScore(this.score),this.ui.setMoves(this.movesLeft)},t.prototype.onDestroy=function(){this.boardView.node&&this.boardView.node.off(h.GameEvents.BoardClicked,this.onBlockClicked,this),cc.systemEvent.off(h.GameEvents.RestartGame,this.resetGame,this),this.boosterPanel&&this.boosterPanel.off(h.GameEvents.BoosterClicked,this.onBoosterClicked,this)},t.prototype.updateBoosters=function(){var e=this;this.boosters.forEach(function(t){var o=e.boosterCounts.get(t.type)||0;t.setBoostLabel(o),t.setInteractable(o>0)})},t.prototype.decBoosterCount=function(e){var t=this.boosterCounts.get(e)-1||0;this.boosterCounts.set(e,t),this.updateBoosters()},t.prototype.updateMoves=function(e,t){void 0===t&&(t=!1),this.busy=!1,this.movesLeft--,this.ui.setMoves(this.movesLeft),this.calculateScore(e.length,t)},t.prototype.calculateScore=function(e,t){void 0===t&&(t=!1);var o=e*e*5;this.score+=t?Math.floor(o/3):o,this.ui.animateScore(this.score)},t.prototype.onBlockClicked=function(e){if(!this.busy)switch(this.inputMode){case s.Normal:this.handleNormalClick(e.row,e.col);break;case s.Bomb:this.handleBomb(e.row,e.col);break;case s.TeleportSelectFirst:case s.TeleportSelectSecond:this.handleTeleport(e.row,e.col)}},t.prototype.onBoosterClicked=function(e){switch(e){case a.BoosterType.Bomb:this.inputMode=s.Bomb;break;case a.BoosterType.Teleport:this.inputMode=s.TeleportSelectFirst}},t.prototype.checkGameState=function(){return this.score>=f.GameConfig.targetScore?(this.ui.winShow("\u041f\u043e\u0431\u0435\u0434\u0430!",this.score),void(this.busy=!0)):this.movesLeft<=0?(this.ui.winShow("\u041f\u0440\u043e\u0438\u0433\u0440\u044b\u0448!",this.score),void(this.busy=!0)):void(this.model.hasAvailableMoves()?this.busy=!1:this.tryReshuffle())},t.prototype.tryReshuffle=function(){var e=this;if(this.reshuffleCount>=this.MAX_RESHUFFLE)return this.ui.winShow("\u0418\u0433\u0440\u0430 \u0437\u0430\u043a\u043e\u043d\u0447\u0435\u043d\u0430!",this.score),void(this.busy=!0);this.reshuffleCount++,this.model.shuffle(),this.boardView.syncWithModel(function(){e.model.hasAvailableMoves()?e.busy=!1:e.tryReshuffle()})},t.prototype.handleNormalClick=function(e,t){var o=this;if(!(this.movesLeft<=0)&&this.model.isValid(e,t)){var r=this.model.get(e,t);if(r.type!==c.BlockType.SuperRow)if(r.type!==c.BlockType.SuperColumn){var i=this.model.findGroup(e,t);i.length<f.GameConfig.minGroup||(this.updateMoves(i),i.length>=f.GameConfig.superTileCount?this.spawnSuperBlock(e,t,i):(this.model.remove(i),this.boardView.playRemove(i,function(){var e=o.model.collapse();o.boardView.playCollapse(e,function(){o.checkGameState()})})))}else this.activateSuperColumn(t);else this.activateSuperRow(e)}},t.prototype.spawnSuperBlock=function(e,t,o){var r=this,i=o.filter(function(o){return!(o.row===e&&o.col===t)});this.model.remove(i);var n=Math.random()>.5?c.BlockType.SuperRow:c.BlockType.SuperColumn;this.model.setBlockType(e,t,n),this.boardView.playRemove(i,function(){r.boardView.updateBlockVisual(e,t,n);var o=r.model.collapse();r.boardView.playCollapse(o,function(){r.checkGameState()})})},t.prototype.handleBomb=function(e,t){var o=this,r=f.GameConfig.bombRadius,i=this.model.getCellsInRadius(e,t,r);0!==i.length?(this.busy=!0,this.inputMode=s.Normal,this.calculateScore(i.length,!0),this.decBoosterCount(a.BoosterType.Bomb),this.model.remove(i),this.boardView.playRemove(i,function(){var e=o.model.collapse();o.boardView.playCollapse(e,function(){o.checkGameState()})})):this.inputMode=s.Normal},t.prototype.handleTeleport=function(e,t){var o=this;if(!this.teleportFirst)return this.teleportFirst=new p.default(e,t),void(this.inputMode=s.TeleportSelectSecond);var r=new p.default(e,t),i=this.teleportFirst;this.busy=!0,this.boardView.playSwap(i,r,function(){o.model.swap(i,r);var e=o.model.findGroup(i.row,i.col),t=o.model.findGroup(r.row,r.col),n=o.model.get(i.row,i.col),s=o.model.get(r.row,r.col);(e.length>=f.GameConfig.minGroup||t.length>=f.GameConfig.minGroup)&&n.color!==s.color&&n.type===c.BlockType.Normal&&n.type===s.type?o.resolveAfterSwap(e,t):o.boardView.playSwap(i,r,function(){o.model.swap(i,r),o.busy=!1})}),this.teleportFirst=null,this.inputMode=s.Normal},t.prototype.resolveAfterSwap=function(e,t){var o=this,r=[];e.length>=f.GameConfig.minGroup&&(r=r.concat(e)),t.length>=f.GameConfig.minGroup&&(r=r.concat(t)),this.calculateScore(r.length),this.decBoosterCount(a.BoosterType.Teleport),this.model.remove(r),this.boardView.playRemove(r,function(){var e=o.model.collapse();o.boardView.playCollapse(e,function(){o.checkGameState()})})},t.prototype.activateSuperRow=function(e){for(var t=[],o=0;o<this.model.cols;o++)t.push(new p.default(e,o));this.destroySuperBlock(t)},t.prototype.activateSuperColumn=function(e){for(var t=[],o=0;o<this.model.rows;o++)t.push(new p.default(o,e));this.destroySuperBlock(t)},t.prototype.destroySuperBlock=function(e){var t=this;this.updateMoves(e,!0),this.model.remove(e),this.boardView.playRemove(e,function(){var e=t.model.collapse();t.boardView.playCollapse(e,function(){t.checkGameState()})})},t.prototype.resetGame=function(){cc.director.loadScene(cc.director.getScene().name)},n([m(l.default)],t.prototype,"boardView",void 0),n([m(u.default)],t.prototype,"ui",void 0),n([m(cc.Node)],t.prototype,"boosterPanel",void 0),n([y],t)}(cc.Component);o.default=v,cc._RF.pop()},{"../board/BoardModel":"BoardModel","../board/BoardView":"BoardView","../booster/BoosterView":"BoosterView","../config/GameConfig":"GameConfig","../config/GameEvents":"GameEvents","../game/types/Cell":"Cell","../ui/UIController":"UIController"}],GameEvents:[function(e,t,o){"use strict";cc._RF.push(t,"a00695JjftIHb5IEIYrU/sF","GameEvents"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameEvents=void 0,function(e){e.TileClicked="tile-clicked",e.BoardClicked="board-clicked",e.BoosterClicked="booster-clicked",e.RestartGame="restart-game"}(o.GameEvents||(o.GameEvents={})),cc._RF.pop()},{}],TilePool:[function(e,t,o){"use strict";cc._RF.push(t,"0655eO0j7FPE4ewo6Eofjh3","TilePool");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./TileView"),c=cc._decorator,l=c.ccclass,a=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefab=null,t.pool=new cc.NodePool,t}return i(t,e),t.prototype.preload=function(e){for(var t=0;t<e;t++){var o=cc.instantiate(this.tilePrefab);this.pool.put(o)}},t.prototype.get=function(){var e,t=(e=this.pool.size()>0?this.pool.get():cc.instantiate(this.tilePrefab)).getComponent(s.default);return t&&(t.row=-1,t.col=-1),t.prepareForAnimation(),e},t.prototype.put=function(e){var t=e.getComponent(s.default);t&&(t.row=-1,t.col=-1),t.prepareForAnimation(),e.removeFromParent(!1),this.pool.put(e)},n([a(cc.Prefab)],t.prototype,"tilePrefab",void 0),n([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./TileView":"TileView"}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"3fb5dgZdBpIW5DoYDzfTaKM","TileView");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../config/GameEvents"),c=cc._decorator,l=c.ccclass,a=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprites=[],t}return i(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.init=function(e,t,o){this.row=e,this.col=t,this.node.setScale(1,1),this.node.opacity=255,this.setType(o)},t.prototype.setType=function(e){this.type=e,this.getComponent(cc.Sprite).spriteFrame=this.sprites[e]},t.prototype.prepareForAnimation=function(){cc.Tween.stopAllByTarget(this.node),this.node.setScale(1,1),this.node.opacity=255},t.prototype.onClick=function(){this.node.parent.emit(s.GameEvents.TileClicked,{row:this.row,col:this.col})},n([a(cc.SpriteFrame)],t.prototype,"sprites",void 0),n([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../config/GameEvents":"GameEvents"}],UIController:[function(e,t,o){"use strict";cc._RF.push(t,"0e3fah0FdBE4Z0fTE2yZ8pf","UIController");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../config/GameConfig"),c=e("../config/GameEvents"),l=cc._decorator,a=l.ccclass,p=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.movesLabel=null,t.winLabel=null,t.winScoreLabel=null,t.displayedScore=0,t.scoreTween=null,t}return i(t,e),t.prototype.setScore=function(e){this.displayedScore=e,this.scoreLabel.string=e+"/"+s.GameConfig.targetScore},t.prototype.setMoves=function(e){this.movesLabel.string=""+e},t.prototype.animateScore=function(e,t){var o=this;void 0===t&&(t=.4),this.scoreTween&&(this.scoreTween.stop(),this.scoreTween=null);var r=s.GameConfig.targetScore,i=this.displayedScore,n=(e=e>r?r:e)-i;0!==n&&(this.scoreTween=cc.tween({value:0}).to(t,{value:1},{easing:"quadOut",progress:function(e,t,s,c){var l=i+n*c;return o.displayedScore=Math.floor(l),o.scoreLabel.string=o.displayedScore+"/"+r,s}}).call(function(){o.displayedScore=e,o.scoreLabel.string=e+"/"+r,o.scoreTween=null}).start())},t.prototype.winShow=function(e,t){var o=this.winLabel.node.parent;this.winLabel.string=e,this.winScoreLabel.string="\u041e\u0427\u041a\u0418: "+t,o.active=!0,o.opacity=0,o.setScale(.8),cc.tween(o).to(.2,{opacity:255}).start(),cc.tween(o).to(.35,{scale:1},{easing:"backOut"}).start()},t.prototype.onClickRestart=function(){cc.systemEvent.emit(c.GameEvents.RestartGame)},n([p(cc.Label)],t.prototype,"scoreLabel",void 0),n([p(cc.Label)],t.prototype,"movesLabel",void 0),n([p(cc.Label)],t.prototype,"winLabel",void 0),n([p(cc.Label)],t.prototype,"winScoreLabel",void 0),n([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../config/GameConfig":"GameConfig","../config/GameEvents":"GameEvents"}]},{},["BoardModel","BoardView","TilePool","TileView","BoosterView","GameConfig","GameEvents","GameController","Cell","UIController"]);